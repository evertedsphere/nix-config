{
  config,
  lib,
  pkgs,
  ...
}: {
  services.keyd = {
    enable = true;
    ids = ["*"];
    settings = {
      main = {
        capslock = "overload(control, esc)";
        tab = "overload(meta, tab)";
        rightalt = "layer(bqn)";
        "q" = "q";
        "w" = "w";
        "e" = "f";
        "r" = "p";
        "t" = "b";
        "y" = "j";
        "u" = "l";
        "i" = "u";
        "o" = "y";
        "p" = ";";
        "[" = "[";
        "]" = "]";
        "a" = "a";
        "s" = "r";
        "d" = "s";
        "f" = "t";
        "g" = "g";
        "h" = "m";
        "j" = "n";
        "k" = "e";
        "l" = "i";
        ";" = "o";
        "'" = "'";
        "\\" = "\\";
        "102nd" = "z";
        "z" = "x";
        "x" = "c";
        "c" = "d";
        "v" = "v";
        "b" = "z";
        "n" = "k";
        "m" = "h";
        "," = ",";
        "." = ".";
        "/" = "/";
      };
      bqn = {
        "space" = "‿";
        "`" = "˜";
        "1" = "˘";
        "2" = "¨";
        "3" = "⁼";
        "4" = "⌜";
        "5" = "´";
        "6" = "˝";
        "7" = "space";
        "8" = "∞";
        "9" = "¯";
        "0" = "•";
        "-" = "÷";
        "equal" = "×";
        "q" = "⌽";
        "w" = "𝕨";
        "e" = "∊";
        "r" = "↑";
        "t" = "∧";
        "u" = "⊔";
        "i" = "⊏";
        "o" = "⊐";
        "p" = "Π";
        "[" = "←";
        "]" = "→";
        "a" = "⍉";
        "s" = "𝕤";
        "d" = "↕";
        "f" = "𝕗";
        "g" = "𝕘";
        "h" = "⊸";
        "j" = "∘";
        "k" = "○";
        "l" = "⟜";
        ";" = "⋄";
        "'" = "↩";
        "z" = "⥊";
        "x" = "𝕩";
        "c" = "↓";
        "v" = "∨";
        "b" = "⌊";
        "m" = "≡";
        "," = "∾";
        "." = "≍";
        "/" = "≠";
        # "<" = "≤";
      };
      "bqn+shift" = {
        "`" = "¬";
        "1" = "⎉";
        "2" = "⚇";
        "3" = "⍟";
        "5" = "⊘";
        "6" = "⎊";
        "7" = "⍎";
        "8" = "⍕";
        "9" = "⟨";
        "0" = "⟩";
        "-" = "√";
        "equal" = "⋆";
        "q" = "↙";
        "w" = "𝕎";
        "e" = "⍷";
        "r" = "𝕣";
        "t" = "⍋";
        "i" = "⊑";
        "o" = "⊒";
        "p" = "⍳";
        "[" = "⊣";
        "]" = "⊢";
        "a" = "↖";
        "s" = "𝕊";
        "f" = "𝔽";
        "g" = "𝔾";
        "h" = "«";
        "k" = "⌾";
        "l" = "»";
        ";" = "·";
        "'" = "˙";
        "z" = "⋈";
        "x" = "𝕏";
        "v" = "⍒";
        "b" = "⌈";
        "m" = "≢";
        "," = "≤";
        "." = "≥";
        "/" = "⇐";
        # "<" = "≥";
      };
    };
  };
}
